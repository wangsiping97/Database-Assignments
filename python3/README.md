<center>
  经56 王思萍 2015012527
</center>

# 新版网络学堂爬虫作业

**作业要求：** 从网络学堂 http://learn.tsinghua.edu.cn/b/kc/v_wlkc_search/pageList 中抓取本学期所有 4340 门使用网络学堂的课程信息，包括课程号（CourseNo）、课序号、课程名称、教师名称、教师号、开课单位及学生数，按院系排序，将结果存入 Excel 文件，并选出所有课程总学生人数最多和最少的教师。

本文将从以下几个方面介绍这个程序的设计思路和整体结构：

- 实现思路
- 遇到的问题与解决方法
- 不足和改进

## 实现思路

本程序实现的内容包括以下两部分：

- 爬虫部分

  爬虫的主干部分助教已经在 `LearnTHU.py` 文件中写好了。我们要做的就是通过使用我们网络学堂的用户名和密码，以及 `get` 和 `post` 函数来获取网址中全部信息的字符串。

- 数据处理部分

  1）通过 `json.loads` 函数将字符串转化为字典格式，通过观察字典的结构，最终得到具有全部课程信息的字典列表 `course_info` ；

  2）建立空字典并通过循环语句与 `append`方法，得到含有要求信息的字典，并转化为 `DataFrame` ，进而进行更改列名、设置索引等细节调整；

  3）通过调用 `DataFrame` 的 `sort_values` 和 `groupby`等函数实现题目要求的数据处理与筛选功能。

## 遇到的问题与解决方法

遇到的主要问题就是题目中给的网址不能直接打开，需要传入一个 `aoData` 的字符串。明确下来是这个问题之后，开始尝试手动传入一些字符串并观察输出。当手动传入了**空字符串** (即 `''` ) 后，观察到一个错误显示 `aoData` 需要是一个 `list` ，因此又进而尝试传入了 `'[]'` ，然后奇迹般地取出了所有需要的信息。

## 不足和改进

1. 不支持在让用户通过在终端中输入用户名和密码的方式来登录。
  
   - 可能的解决方案：实现上述功能。
2. "按院系排序"没有实现通常所认为的按词典序(拼音)排序。
   - 可能的解决方案：学习使用python的其他库，实现按词典序排序。
